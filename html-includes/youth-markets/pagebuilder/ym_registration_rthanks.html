[[?COMMENT::::::
   NOT PART OF DEPLOYMENT PROCESS. MUST BE MANUALLY COPIED TO PAGEBUILDER.
]]

[[U0:frCompanyId=]]
[[U0:frTJoin=]]

[[?[[S8]]::/admin/::
  <!-- on admin-facing page -->
::
  <!-- on user-facing page -->
  [[?xTx::x[[A60]]x::
    <!-- already registered error -->
    <div class="ym-registration-page-container ym-registration-page-container--rthanks">
      <div class="ym-registration-page-header">
        <div class="manageable-content" data-container="edit_title_container">
          <h2 class="h4" id="title_container">
            [[C1:fr_reg_thanks_page_title]]
          </h2>
        </div>
        [[?xyz.xnullynullz.xynullz.xnullyz::x[[A4]]y[[A8]]z::::
          <div class="alert alert-danger" role="alert">
            [[?xy.xnully::x[[A4]]y::
              [[M0:friendraiser:generic_error]]
            ::
              Our records indicate that you have already registered for this event.  To register another person, please <a href="UserLogin?logout=&amp;NEXTURL=[[T1:[[E130:[[T8:[[S8]]]] [[T8:&amp;]] [[T8:&]] replaceall]]]]">log out</a> and begin the registration process again.
              <!-- [[A4]] -->
            ]]
          </div>
        ]]
        [[?xxnullxBASELINEx::x[[S0:TPV_FR_CSTM_THX_STANDARD_SHOW_PRTCTRLINK]]x::
          <p>
            <span id="part_center_link_title">
              [[M1:friendraiser:participant_center_link_title]] 
            </span>
          </p>
        ::]]
      </div>
      [[?xxnullxBASELINEx::x[[S0:TPV_FR_CSTM_THX_STANDARD_SHOW_PRTCTRLINK]]x::
        <div class="manageable-content" data-container="edit_part_ctr_container">
          <a class="btn btn-primary" id="part_ctr_container" href="[[A37]]">
            [[?xxnullx::x[[C1:fr_access_part_ctr_link]]x::
              <strong>[[M1:friendraiser:access_part_ctr_link]]</strong> <i class="fa fa-chevron-right"></i>
            ::
              <strong>[[C1:fr_access_part_ctr_link]]</strong> <i class="fa fa-chevron-right"></i>
            ]]
          </a>
        </div>
      ::]]
    </div>
  ::
    <!-- thank you page -->
    [[?xSchool Not Foundx::x[[S42:0:public-event-type]]x::
      <p>
        Thank you for registering! We're thrilled you're participating!
      </p>
      <p>
        We'll now work on making sure you're properly linked up with your school. A school coordinator from our team will hop on that and let you know when you can log in and start your fundraising!
      </p>
      <p>
        Thank you again for supporting the American Heart Association!
      </p>
    ::
      <style>
        body {
          display: none;
        }
      </style>
      <div class="hidden" hidden aria-hidden="true">
        <img ng-src="//hearttools.heart.org/aha_ym18/api/student/register/[[S80:trID]]/[[S1:cons_id]]?team_id=[[E48:[[S80:trID]]-[[S1:cons_id]]:team-id]]&amp;school_id=[[E43:[[S80:trID]]:company-id:[[E48:[[S80:trID]]-[[S1:cons_id]]:team-id]]]]" alt="">
      </div>
      <div class="tracking-code">[[A31]]</div>
      <script>
        var redirectToParticipantCenter = function() {
          [[?x4556x::x[[S334:fr_id]]x::

            if (jQuery('.tracking-code').text().length > 0) {
                // Add tracking code to local storage for Double the Donation 
                console.log('there is a tracking code');
                var trackingCode = jQuery('.tracking-code').text();
                console.log('trackingCode' + trackingCode);
                localStorage.trackingCode = trackingCode;
            }
            else {
                console.log('clear tracking code'); 
                localStorage.trackingCode = "";
            }
            
            window.location = 'https://[[S29:SECURE_DOMAIN]][[S29:SECURE_PATH]]TRSC?fr_id=[[A2]]&pg=center';
          ::
            window.location = 'https://[[S29:SECURE_DOMAIN]][[S29:SECURE_PATH]]TRSC?fr_id=[[A2]]&pg=center';
          ]]
        };
        if(pushRegSuccessToDataLayer) {
          pushRegSuccessToDataLayer();
          setTimeout(function() {
            redirectToParticipantCenter();
          }, 3000);
        }
        else {
          redirectToParticipantCenter();
        }
      </script>
    ]]
  ]]
]]